<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-hello-world" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/11/21/hello-world/" class="article-date">
  <time class="dt-published" datetime="2022-11-21T13:37:56.999Z" itemprop="datePublished">2022-11-21</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/11/21/hello-world/">Hello World</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>Welcome to <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a target="_blank" rel="noopener" href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a target="_blank" rel="noopener" href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a target="_blank" rel="noopener" href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/11/21/hello-world/" data-id="claqum2dg000hh0tke7ej7g35" data-title="Hello World" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-搭建自己的博客并进行相应的同步" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/11/12/%E6%90%AD%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84%E5%8D%9A%E5%AE%A2%E5%B9%B6%E8%BF%9B%E8%A1%8C%E7%9B%B8%E5%BA%94%E7%9A%84%E5%90%8C%E6%AD%A5/" class="article-date">
  <time class="dt-published" datetime="2022-11-12T01:42:05.000Z" itemprop="datePublished">2022-11-12</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/11/12/%E6%90%AD%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84%E5%8D%9A%E5%AE%A2%E5%B9%B6%E8%BF%9B%E8%A1%8C%E7%9B%B8%E5%BA%94%E7%9A%84%E5%90%8C%E6%AD%A5/">搭建自己的博客并进行相应的同步</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>有些笔记是在印象笔记上面的，但是目前自己已经遇到了同步的问题了，所以自己也是很想把这个问题给彻底的解决掉。<br>但是同步就会出现这样那样的问题，所以一时间自己也没有很好的解决办法，只能在网上寻求一些帮助<br>通常的解决方案是通过代理服务器连接，但由于大部分的代理软件（如v2rayN等），只能更改系统的代理设置，，像Gridea这些不遵守系统代理设置的软件，无法通过代理服务器连接。<br>下面介绍一种本人亲测有效的方法, 这种方法的基本原理是用GitHub Desktop将Gridea生成的网页源代码手动push到GitHub上。</p>
<p>关于关联Gridea的一些问题：</p>
<p>如何把本地的项目推送到远程的仓库。主要有以下的两种方式：</p>
<p>在远程新建一个仓库，在本地克隆下来，然后把项目代码给搬上去，然后再推上去</p>
<p>通过git命令，在本地项目直接操作，让它变成一个仓库，再配置远程的仓库地址，然后给它推送上去（主要用第二种），以下主要是针对第二种情况的一个详细的步骤说明：</p>
<p>1、在项目根目录初始化 Git 仓库，这样可以通过 Git 管理代码：git init </p>
<p>2、添加内容到暂存区：git add . </p>
<p>3、提交到仓库区：git commit -m ‘init’ </p>
<p>4、配置 remote 仓库地址，和远程仓库关联起来：git remote add origin 远程仓库地址 </p>
<p>5、把当前分支 master 推送到远程 master 分支：git push origin master -u</p>
<p>几行重要的代码：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">git init </span><br><span class="line">git add . </span><br><span class="line">git commit -m &#x27;init&#x27;</span><br><span class="line">git remote add origin</span><br><span class="line">git push origin master -u</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/11/12/%E6%90%AD%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84%E5%8D%9A%E5%AE%A2%E5%B9%B6%E8%BF%9B%E8%A1%8C%E7%9B%B8%E5%BA%94%E7%9A%84%E5%90%8C%E6%AD%A5/" data-id="claqum2ec002gh0tkezrp1y5j" data-title="搭建自己的博客并进行相应的同步" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-vs code导入本地工具包" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/10/03/vs%20code%E5%AF%BC%E5%85%A5%E6%9C%AC%E5%9C%B0%E5%B7%A5%E5%85%B7%E5%8C%85/" class="article-date">
  <time class="dt-published" datetime="2022-10-03T07:16:38.000Z" itemprop="datePublished">2022-10-03</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/10/03/vs%20code%E5%AF%BC%E5%85%A5%E6%9C%AC%E5%9C%B0%E5%B7%A5%E5%85%B7%E5%8C%85/">关于vs code导入本地工具包和消除&#39;import [module] could not be resolved in pylance&#39;</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p><img src="https://runnerxr.github.io/post-images/1664781721250.jpg"><br>也是在遇到这个问题的时候想到要做一些相应的解决的办法，需要用到自定义的工具类模块，总结下来主要就是两个问题：</p>
<ol>
<li>如何导入自定义模块</li>
<li>解决vs code警告’import [module] could not be resolved in pylance’和实现包高亮与转到定义<br>参考链接：[<a target="_blank" rel="noopener" href="https://www.freesion.com/article/73711450476/]">https://www.freesion.com/article/73711450476/]</a><br>以下是别人的解决的方法，自己就是拿来做一下相应的整理和学习<br>准备相应的测试文件：</li>
</ol>
<p>补充说明：<br>python与c#的交互模块pythonnet<br>微软有相应的解释器，就是<strong>Ironpython</strong>,但是Ironpython还有很多的东西在python中没有继承过来，所以有的时候用的并不是很爽，pythonnet就是一个很好的模块，<strong>它可以平滑的和C#进行相应的交互</strong><br>参考链接：[<a target="_blank" rel="noopener" href="https://www.cnblogs.com/ExMan/p/10165749.html]">https://www.cnblogs.com/ExMan/p/10165749.html]</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># clr是公共运行时的环境，这个模块时与c#交互的核心</span></span><br><span class="line"><span class="keyword">import</span> clr</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="comment"># 导入clr时这个模块最好一起导入，这样就可以用AddReference方法</span></span><br><span class="line"><span class="keyword">import</span> System </span><br><span class="line">sys.path.append(<span class="string">r&#x27;d:dll&#x27;</span>)  <span class="comment"># 加载c#dll文件</span></span><br><span class="line"><span class="keyword">from</span> classLibraay5.aaaaa <span class="keyword">import</span> *  <span class="comment"># 导入命名空间</span></span><br><span class="line">a = clr.AddReference(<span class="string">&#x27;ClassLibrary5&#x27;</span>)   <span class="comment"># 实例化c#类库，这样可以调用，比如这个类的来源Location</span></span><br><span class="line">c1 = bbbb()</span><br><span class="line"><span class="built_in">print</span> a.Location</span><br><span class="line">c1.a()</span><br><span class="line"><span class="built_in">print</span> <span class="built_in">dir</span>(System)</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/10/03/vs%20code%E5%AF%BC%E5%85%A5%E6%9C%AC%E5%9C%B0%E5%B7%A5%E5%85%B7%E5%8C%85/" data-id="claqum2dt001bh0tkfqfj28fh" data-title="关于vs code导入本地工具包和消除&#39;import [module] could not be resolved in pylance&#39;" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-关于matalab的数据分析" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/09/25/%E5%85%B3%E4%BA%8Ematalab%E7%9A%84%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/" class="article-date">
  <time class="dt-published" datetime="2022-09-25T15:08:47.000Z" itemprop="datePublished">2022-09-25</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/09/25/%E5%85%B3%E4%BA%8Ematalab%E7%9A%84%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/">关于matalab的数据分析</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>选波的程序大致是能够行的通了，但是最好自己能够明白其中的缘由最好，毕竟还是要学以致用：<br>不要小看这几行代码，也许在以后的工作中会发挥比较大的作用，也希望这能帮助以后的工作的开展</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">struct2cell：</span><br><span class="line">C = struct2cell(S) 将结构体转换为元胞数组。元胞数组 C 包含从 S 的字段复制的值。</span><br><span class="line">struct2cell 函数不返回字段名称。要返回元胞数组中的字段名称，请使用 fieldnames 函数。</span><br><span class="line"></span><br><span class="line">dir：列出当前文件夹中的文件和文件夹</span><br><span class="line">dir name：列出与 name 匹配的文件和文件夹。如果 name 为文件夹，dir 列出该文件夹的内容。使用绝对或相对路径名称指定 name。name 参数的文件名可以包含 * 通配符，路径名称可以包含 * 和 ** 通配符。与 ** 通配符相邻的字符必须为文件分隔符。</span><br><span class="line">listing = dir(name)：返回 name 的属性。</span><br><span class="line"></span><br><span class="line">strcat：水平串联字符串</span><br><span class="line">s = strcat(s1,...,sN)</span><br><span class="line">s = strcat(s1,...,sN) 水平串联 s1,...,sN。每个输入参数都可以是字符数组、字符向量元胞数组或字符串数组。</span><br><span class="line">* 如果任一输入是字符串数组，则结果是字符串数组。</span><br><span class="line">* 如果任一输入是元胞数组，并且没有输入是字符串数组，则结果是字符向量元胞数组。</span><br><span class="line">* 如果所有输入都是字符数组，则结果是字符数组。</span><br><span class="line">对于字符数组输入，strcat 会删除尾随的 ASCII 空白字符：空格、制表符、垂直制表符、换行符、回车和换页符。对于元胞数组和字符串数组输入，strcat 不删除尾随空白。</span><br><span class="line"></span><br><span class="line">char:字符数组，是一个字符序列，将一小段文本作为一行字符存储在字符向量里面</span><br><span class="line">C = char(A) 将数组 A 转换为字符数组。</span><br><span class="line">C = char(A1,...,An) 将数组 A1,...,An 转换为单个字符数组。转换为字符后，输入数组变为 C 中的行。char 函数会根据需要使用空格填充行。如果任何输入数组是空字符数组，则 C 中相应的行是一行空格。</span><br><span class="line">输入数组 A1,...,An 不能是字符串数组、元胞数组或分类数组。</span><br><span class="line">A1,...,An 可以是不同的大小和形状。</span><br><span class="line">C = char(D) 以 D 的 Format 属性指定的格式将日期时间、持续时间或日历持续时间数组转换为单个字符数组。输出在每行中包含一个日期或持续时间。</span><br><span class="line">C = char(D,fmt) 以指定的格式（例如 <span class="string">&#x27;HH:mm:ss&#x27;</span>）表示日期或持续时间。</span><br><span class="line">C = char(D,fmt,locale) 以指定的区域设置（例如 <span class="string">&#x27;en_US&#x27;</span>）表示日期或持续时间。区域设置会影响用于表示字符向量（例如月和日期名称）的语言。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">fopen：打开文件或获得有关打开文件的信息</span><br><span class="line">fileID = fopen(filename)：打开文件 filename 以便以二进制读取形式进行访问，并返回等于或大于 <span class="number">3</span> 的整数文件标识符。</span><br><span class="line">fileID = fopen(filename,permission)：将打开由 permission 指定访问类型的文件。</span><br><span class="line">fileID = fopen(filename,permission,machinefmt,encodingIn)：使用 machinefmt 参数另外指定在文件中读写字节或位时的顺序。可选的 encodingIn 参数指定与文件相关联的字符编码方案。</span><br><span class="line"></span><br><span class="line">fgetl：读取文件中的行，并删除换行符</span><br><span class="line">textscan：从文本文件或字符串读取格式化数据</span><br><span class="line">C = textscan(fileID,formatSpec)</span><br><span class="line">C = textscan(fileID,formatSpec,N)</span><br><span class="line">C = textscan(chr,formatSpec)</span><br><span class="line">C = textscan(chr,formatSpec,N)</span><br><span class="line">C = textscan(___,Name,Value)</span><br><span class="line">[C,position] = textscan(___)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">fclose：关闭一个或所有打开的文件</span><br><span class="line">fclose(fileID)： 关闭打开的文件</span><br><span class="line">fclose(<span class="string">&#x27;all&#x27;</span>)： 关闭所有打开的文件。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">num2cell</span>：将数组转换为相同大小的元胞数组，函数转换具有任意数据类型（甚至是非数值类型）的数组。</span><br><span class="line"></span><br><span class="line">importdata：从文件加载数据</span><br><span class="line"></span><br><span class="line"><span class="built_in">plot</span>(X,Y)：创建 Y 中数据对 X 中对应值的二维线图</span><br><span class="line">备注：</span><br><span class="line">* 如果 X 和 Y 都是向量，则它们的长度必须相同。<span class="built_in">plot</span> 函数绘制 Y 对 X 的图。</span><br><span class="line">* 如果 X 和 Y 均为矩阵，则它们的大小必须相同。<span class="built_in">plot</span> 函数绘制 Y 的列对 X 的列的图。</span><br><span class="line">* 如果 X 或 Y 中的一个是向量而另一个是矩阵，则矩阵的各维中必须有一维与向量的长度相等。如果矩阵的行数等于向量长度，则 <span class="built_in">plot</span> 函数绘制矩阵中的每一列对向量的图。如果矩阵的列数等于向量长度，则该函数绘制矩阵中的每一行对向量的图。如果矩阵为方阵，则该函数绘制每一列对向量的图。</span><br><span class="line">* 如果 X 或 Y 之一为标量，而另一个为标量或向量，则 <span class="built_in">plot</span> 函数会绘制离散点。但是，要查看这些点，您必须指定标记符号，例如 <span class="built_in">plot</span>(X,Y,<span class="string">&#x27;o&#x27;</span>)。</span><br><span class="line"></span><br><span class="line"><span class="built_in">plot</span>(X,Y,LineSpec)：设置线型、标记符号和颜色</span><br><span class="line"><span class="built_in">plot</span>(X1,Y1,...,Xn,Yn)：绘制多个 X、Y 对组的图，所有线条都使用相同的坐标区</span><br><span class="line"><span class="built_in">plot</span>(X1,Y1,LineSpec1,...,Xn,Yn,LineSpecn)：设置每个线条的线型、标记符号和颜色。您可以混用 X、Y、LineSpec 三元组和 X、Y 对组：例如：<span class="built_in">plot</span>(X1,Y1,X2,Y2,LineSpec2,X3,Y3)。</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/09/25/%E5%85%B3%E4%BA%8Ematalab%E7%9A%84%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/" data-id="claqum2dv001gh0tkasq3fp28" data-title="关于matalab的数据分析" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-关于python爬虫一点小的整理" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/07/30/%E5%85%B3%E4%BA%8Epython%E7%88%AC%E8%99%AB%E4%B8%80%E7%82%B9%E5%B0%8F%E7%9A%84%E6%95%B4%E7%90%86/" class="article-date">
  <time class="dt-published" datetime="2022-07-30T13:42:45.000Z" itemprop="datePublished">2022-07-30</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/07/30/%E5%85%B3%E4%BA%8Epython%E7%88%AC%E8%99%AB%E4%B8%80%E7%82%B9%E5%B0%8F%E7%9A%84%E6%95%B4%E7%90%86/">关于python爬虫一点小的整理</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>以一个例子作为开头</p>
<h1 id="从大师网站自动下载项目的高清图片"><a href="#从大师网站自动下载项目的高清图片" class="headerlink" title="从大师网站自动下载项目的高清图片"></a>从大师网站自动下载项目的高清图片</h1><p>参考链接：<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/pqFR4TigBCS--barsfuz1A">https://mp.weixin.qq.com/s/pqFR4TigBCS--barsfuz1A</a><br>这个程序写的有点东西，而且这个例子说实话是有点偏难的，因为已经用到了一些爬虫相关的知识点，这也是自己没能掌握的，不过这些东西都是自己后面会掌握的一部分，所以也没啥好说的。<br>没有使用<strong>Selenium</strong>，采用纯代码的方式，省下浏览器打开图片渲染页面的时间消耗<br>具体的步骤如下：</p>
<ol>
<li>访问网站</li>
<li>找到有哪些项目，以及项目的详细介绍网页</li>
<li>在项目的详细介绍网页中找到高清大图的地址</li>
<li>下载图片</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 导入requests：是python实现的简单易用的HTTP库</span></span><br><span class="line"><span class="comment"># 导入re库：re库是python的标准库，主要用于字符串匹配</span></span><br><span class="line"><span class="keyword">import</span> requests, re, os</span><br><span class="line"><span class="comment"># Beautifulsoup包：用python写的一个HTML/XML的解析器，可以很好的处理不规则标记并生成剖析树（parse tres）,他提供了简单又常用的导航（navigating）,搜索以及修改剖析树的操作，大大节省编程的时间。</span></span><br><span class="line"><span class="comment"># 使用from bs4 import BeautifulSoup直接将BeautifulSoup类导入到当前命名空间，直接使用，不需要再带包名</span></span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输入大师的网址，这里的r是转义符，即raw string，会自动的将反斜杠进行相应的转义</span></span><br><span class="line">project_url = <span class="string">r&#x27;https://calatrava.com/projects.html?all=yes&#x27;</span></span><br><span class="line"><span class="comment"># 访问网站的模块，以后需要访问网站的时候都会用到这个函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">download_page</span>(<span class="params">url</span>):</span><br><span class="line">    headers = &#123;<span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 6.1; WOW64; rv:23.0) Gecko/20100101 Firefox/23.0&#x27;</span></span><br><span class="line">               &#125;</span><br><span class="line">    data = requests.get(url, headers=headers).content.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line"><span class="comment">#####从页面的html语言中解析出项目地址</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 解析得到标题与项目地址的列表</span></span><br><span class="line"><span class="comment"># 拆分出：1.每个项目的信息</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse_html</span>(<span class="params">url</span>):</span><br><span class="line">    html = download_page(url)</span><br><span class="line">    soup = BeautifulSoup(html, features=<span class="string">&#x27;lxml&#x27;</span>)</span><br><span class="line">    project_list_part=soup.find(<span class="string">&quot;div&quot;</span>,&#123;<span class="string">&quot;class&quot;</span>:<span class="string">&quot;mod_cal_project_list thumb_view block&quot;</span>&#125;)</span><br><span class="line">    project_list_soup = project_list_part.find_all(<span class="string">&#x27;li&#x27;</span>, &#123;<span class="string">&#x27;class&#x27;</span>: &#123;<span class="string">&#x27;odd&#x27;</span>,<span class="string">&quot;even&quot;</span>&#125;&#125;)</span><br><span class="line">    <span class="keyword">return</span> project_list_soup</span><br><span class="line"></span><br><span class="line"><span class="comment"># 在项目信息中提取项目的名称，得到一个列表</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_project_title</span>(<span class="params">project_list_soup</span>):</span><br><span class="line">    project_title = []</span><br><span class="line">    <span class="keyword">for</span> link <span class="keyword">in</span> project_list_soup:</span><br><span class="line">        project_year = link.find(<span class="string">&#x27;span&#x27;</span>, &#123;<span class="string">&#x27;class&#x27;</span>: <span class="string">&#x27;year&#x27;</span>&#125;)</span><br><span class="line">        links = link.find(<span class="string">&#x27;a&#x27;</span>)[<span class="string">&#x27;href&#x27;</span>]</span><br><span class="line">        name = <span class="built_in">str</span>(project_year.string) + <span class="string">&#x27;--&#x27;</span>+ <span class="built_in">str</span>(links[<span class="number">9</span>:-<span class="number">5</span>])</span><br><span class="line">        project_title.append(name)</span><br><span class="line">    <span class="keyword">return</span> project_title</span><br><span class="line"></span><br><span class="line"><span class="comment"># 解析出每个项目的地址，得到一个列表</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_project_link</span>(<span class="params">project_list_soup</span>):</span><br><span class="line">    project_link = []</span><br><span class="line">    <span class="keyword">for</span> link <span class="keyword">in</span> project_list_soup:</span><br><span class="line">        links = link.find(<span class="string">&#x27;a&#x27;</span>)[<span class="string">&#x27;href&#x27;</span>]</span><br><span class="line">        <span class="comment">#因为项目的详细页面的默认状态是看文字介绍，所以还需要在后面加入一个进入画廊状态的字符串</span></span><br><span class="line">        links = <span class="built_in">str</span>(<span class="string">r&quot;https://calatrava.com/&quot;</span> + links+<span class="string">r&quot;?view_mode=gallery&quot;</span>)</span><br><span class="line">        project_link.append(links)</span><br><span class="line">    <span class="keyword">return</span> project_link</span><br><span class="line"></span><br><span class="line"><span class="comment">### 在项目详细介绍的网页找到高清大图的地址（解析出隐藏在翻页动画背后的高清大图的存储结构）</span></span><br><span class="line"><span class="comment">### 页面的动画效果是通过一个JavaScript代码实现的，每个项目的大图都是结构化的存储在这段json对象中，直接用正则表达式提取出来就可以</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 解析项目子项页面，得到图片地址的列表</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse_sub_html</span>(<span class="params">project_link</span>):</span><br><span class="line">    html = download_page(project_link)</span><br><span class="line">    project_soup = BeautifulSoup(html, features=<span class="string">&#x27;lxml&#x27;</span>)</span><br><span class="line">    <span class="comment"># 抓取JavaScript代码，解析出图片存放的实际地址</span></span><br><span class="line">    project_img_links_script=project_soup.find_all(<span class="string">&quot;script&quot;</span>)</span><br><span class="line">    project_img_links=re.findall(<span class="string">r&quot;&#x27;(?P&lt;addr&gt;files.*)&#x27;,  title&quot;</span>,<span class="built_in">str</span>(project_img_links_script))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(project_img_links)):</span><br><span class="line">        project_img_links[i]=<span class="built_in">str</span>(<span class="string">r&quot;https://calatrava.com/&quot;</span>)+project_img_links[i]</span><br><span class="line">    <span class="comment"># print(str(project_img_links_script))</span></span><br><span class="line">    <span class="built_in">print</span>(project_img_links)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;此项目大图数量 = &quot;</span>+<span class="string">&quot;len(project_img_links&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> project_img_links</span><br><span class="line"></span><br><span class="line"><span class="comment"># 根据图片地址的列表，设定命名规则，保存图片</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">save_img</span>(<span class="params">links, name</span>):</span><br><span class="line">    headers = &#123;<span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 6.1; WOW64; rv:23.0) Gecko/20100101 Firefox/23.0&#x27;</span>&#125;</span><br><span class="line">    os.makedirs(<span class="string">&#x27;./Calatrava project img/&#x27;</span>, exist_ok=<span class="literal">True</span>)</span><br><span class="line">    t = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> link <span class="keyword">in</span> links:</span><br><span class="line">        filename = <span class="built_in">str</span>(<span class="string">&#x27;./Calatrava project img/&#x27;</span> + <span class="built_in">str</span>(name) + <span class="string">&#x27;%s.jpg&#x27;</span> % (<span class="built_in">repr</span>(t)))</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Downloading----&quot;</span>,<span class="built_in">str</span>(filename))</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> img:</span><br><span class="line">            img.write(requests.get(link, headers=headers).content)</span><br><span class="line">            t += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 组装成一个main函数运行就可以进行后面的收图工作</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    soup = parse_html(project_url)</span><br><span class="line">    <span class="comment"># 得到项目名称以及项目地址</span></span><br><span class="line">    name = get_project_title(soup)</span><br><span class="line">    link = get_project_link(soup)</span><br><span class="line">    <span class="built_in">print</span>(link)</span><br><span class="line">    <span class="comment"># 进入项目子项地址下载图片</span></span><br><span class="line">    <span class="comment"># 引入项目代号t可以从第t个项目开始下载，以防网络错误</span></span><br><span class="line">    t = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> t &lt; <span class="built_in">len</span>(name):</span><br><span class="line">        <span class="comment"># 考虑空项目地址引起download函数报错</span></span><br><span class="line">        <span class="keyword">if</span> link[t] == <span class="string">&quot;&quot;</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Skip it,Because it is null,Hurry coding,,Fix it later&quot;</span>)</span><br><span class="line">            t += <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            img_list = parse_sub_html(link[t])</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;Project Name is :&#x27;</span>, name[t])</span><br><span class="line">            save_name = <span class="built_in">str</span>(<span class="built_in">repr</span>(t + <span class="number">1</span>)+<span class="string">&quot;-&quot;</span> + name[t])</span><br><span class="line">            save_img(img_list, save_name)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;No %s is ok&#x27;</span> % <span class="built_in">repr</span>(t + <span class="number">1</span>))</span><br><span class="line">            t += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/07/30/%E5%85%B3%E4%BA%8Epython%E7%88%AC%E8%99%AB%E4%B8%80%E7%82%B9%E5%B0%8F%E7%9A%84%E6%95%B4%E7%90%86/" data-id="claqum2dy001mh0tka4qz6q5s" data-title="关于python爬虫一点小的整理" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-关于查询自己到底安装了哪些包" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/07/30/%E5%85%B3%E4%BA%8E%E6%9F%A5%E8%AF%A2%E8%87%AA%E5%B7%B1%E5%88%B0%E5%BA%95%E5%AE%89%E8%A3%85%E4%BA%86%E5%93%AA%E4%BA%9B%E5%8C%85/" class="article-date">
  <time class="dt-published" datetime="2022-07-30T10:10:50.000Z" itemprop="datePublished">2022-07-30</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/07/30/%E5%85%B3%E4%BA%8E%E6%9F%A5%E8%AF%A2%E8%87%AA%E5%B7%B1%E5%88%B0%E5%BA%95%E5%AE%89%E8%A3%85%E4%BA%86%E5%93%AA%E4%BA%9B%E5%8C%85/">关于查询自己到底安装了哪些包</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>因为自己也确实安装了很多的包，但是后面肯定会对有些包的安装与否做一个深入的了解的</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/07/30/%E5%85%B3%E4%BA%8E%E6%9F%A5%E8%AF%A2%E8%87%AA%E5%B7%B1%E5%88%B0%E5%BA%95%E5%AE%89%E8%A3%85%E4%BA%86%E5%93%AA%E4%BA%9B%E5%8C%85/" data-id="claqum2dx001lh0tke5bq8jvr" data-title="关于查询自己到底安装了哪些包" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-双频段选波方法" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/07/19/%E5%8F%8C%E9%A2%91%E6%AE%B5%E9%80%89%E6%B3%A2%E6%96%B9%E6%B3%95/" class="article-date">
  <time class="dt-published" datetime="2022-07-19T15:07:05.000Z" itemprop="datePublished">2022-07-19</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/07/19/%E5%8F%8C%E9%A2%91%E6%AE%B5%E9%80%89%E6%B3%A2%E6%96%B9%E6%B3%95/">双频段选波方法</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>两段选取地震波的代码，这里收集在这里，方便后续可能会用到的一些东西：<br>方法一：NewMark</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line">function Res = Newmark(Acc,DT,T,kesi,IND)</span><br><span class="line">    % parameters</span><br><span class="line">    NT = max(size(T,1),size(T,2));</span><br><span class="line">    NPTS = max(size(Acc,1),size(Acc,2));</span><br><span class="line">    DDY = Acc;</span><br><span class="line">    %% Maxima of input motion</span><br><span class="line">    Emax(1) =max( abs(DDY));</span><br><span class="line">    Emax(2) = 0.0;</span><br><span class="line">    Emax(3) = 0.0;</span><br><span class="line">    DDYF = DDY(1);</span><br><span class="line">    DYF = 0.0;</span><br><span class="line">    YF = 0.0;</span><br><span class="line">    %% Computation of the maximun of a,v,d of the ground motion</span><br><span class="line">%     for i = 2:NPTS</span><br><span class="line">%         DDYM = DDY(i);</span><br><span class="line">%         DY = DYF + (DDYF+DDYM)*DT/2.0;</span><br><span class="line">%         Y = YF + DYF*DT + (DDYF/3.+ DDYM/6.)*DT*DT;</span><br><span class="line">%         Emax(1) = max(Emax(1),abs(DDYM));</span><br><span class="line">%         Emax(2) = max(Emax(2),abs(DY));</span><br><span class="line">%         Emax(3) = max(Emax(3),abs(Y));</span><br><span class="line">%         DDYF  = DDYM;</span><br><span class="line">%         DYF = DY;</span><br><span class="line">%         YF = Y;</span><br><span class="line">%     end</span><br><span class="line">    %Qmax = Emax(IND);%</span><br><span class="line">    %% Response Computation</span><br><span class="line">    H =kesi;</span><br><span class="line">    Res = zeros(1,NT);</span><br><span class="line">    for i = 1:NT</span><br><span class="line">        if (T(i) ==0.0 &amp; IND == 1)</span><br><span class="line">        		Res(i) = Emax(1);</span><br><span class="line">		elseif(T(i) ==0.0 &amp;  IND ~= 1)</span><br><span class="line">				Res(i) =0.0;</span><br><span class="line">        else</span><br><span class="line">           W = pi*2/T(i);</span><br><span class="line">           W2 = W*W;</span><br><span class="line">           HW = H*W;</span><br><span class="line">           WD = W*sqrt(1-H.^2);</span><br><span class="line">           WDT = WD*DT;</span><br><span class="line">           E = exp(-HW*DT);</span><br><span class="line">           CWDT = cos(WDT);</span><br><span class="line">           SWDT = sin(WDT);</span><br><span class="line">           A11 = E*(CWDT+HW*SWDT/WD);</span><br><span class="line">           A12 = E*SWDT/WD;</span><br><span class="line">           A21 = -E*W2*SWDT/WD;</span><br><span class="line">           A22 = E*(CWDT-HW*SWDT/WD);</span><br><span class="line">           SS = -HW*SWDT - WD*CWDT;</span><br><span class="line">           CC = -HW*CWDT + WD*SWDT;</span><br><span class="line">           S1 = (E*SS + WD)/W2;</span><br><span class="line">           C1 = (E*CC + HW)/W2;</span><br><span class="line">           S2 = (E*DT*SS + HW*S1 + WD*C1)/W2;</span><br><span class="line">           C2 = (E*DT*CC + HW*C1 - WD*S1)/W2;</span><br><span class="line">           S3 = DT*S1-S2;</span><br><span class="line">           C3 = DT*C1-C2;</span><br><span class="line">           B11 = -S2/WDT;</span><br><span class="line">           B12 = -S3/WDT;</span><br><span class="line">           B21 = (HW*S2 - WD*C2)/WDT;</span><br><span class="line">           B22 = (HW*S3 - WD*C3)/WDT;</span><br><span class="line">           Rmax(1) = 2.*HW*abs(DDY(1))*DT;</span><br><span class="line">           Rmax(2) = abs(DDY(1))*DT;</span><br><span class="line">           Rmax(3) = 0.0;</span><br><span class="line">           DXF = -DDY(1)*DT;</span><br><span class="line">           XF = 0.0;</span><br><span class="line">           for k = 2:NPTS</span><br><span class="line">               DDYM = DDY(k);</span><br><span class="line">               DDYF = DDY(k-1);</span><br><span class="line">               X = A12*DXF + A11*XF + B12*DDYM + B11*DDYF;</span><br><span class="line">               DX = A22*DXF + A21*XF + B22*DDYM + B21*DDYF;</span><br><span class="line">               DDX = -2.*HW*DX - W2*X;</span><br><span class="line">               Rmax(1) = max(Rmax(1),abs(DDX));</span><br><span class="line">               Rmax(2) = max(Rmax(2),abs(DX));</span><br><span class="line">               Rmax(3) = max(Rmax(3),abs(X));</span><br><span class="line">               DXF = DX;</span><br><span class="line">               XF = X;</span><br><span class="line">           end</span><br><span class="line">		   Res(i)=Rmax(IND);</span><br><span class="line">        end</span><br><span class="line">    end</span><br><span class="line">end</span><br><span class="line">%% Newmark-Method To calculate the Response-SPEC of ground motion;</span><br><span class="line">%   Acc: the Ground Motion To be calculate;</span><br><span class="line">%   DT:  the time increment of the ground motion</span><br><span class="line">%   T:   the Perids of the Response_SPEC</span><br><span class="line">%   kesi:damping_ratio</span><br><span class="line">% IND: 1 Sa; 2 Sv; 3 Sd</span><br></pre></td></tr></table></figure>

<p>方法二：谱加速度法</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line">clear;</span><br><span class="line">clc;</span><br><span class="line">S1= [];</span><br><span class="line">dirs=dir(&#x27;F:\1study\2earthquake\1seismic\*.AT2&#x27;);</span><br><span class="line">dircell=struct2cell(dirs)&#x27; ; </span><br><span class="line">filenames=dircell(:,1);</span><br><span class="line">filenames1=strcat(&#x27;F:\1study\2earthquake\1seismic\&#x27;,filenames);</span><br><span class="line">n=length(filenames1);</span><br><span class="line">PGA=0.07;  %%目标PGA</span><br><span class="line">%%</span><br><span class="line">% Tt1=0.831;   %%结构基本周期</span><br><span class="line">% Tt2=0.263;   %%结第二周期</span><br><span class="line">% Tt3=0.146;   %%结构第三周期</span><br><span class="line">%%</span><br><span class="line">Tt1=1.578;   %%结构基本周期</span><br><span class="line">Tt2=0.499;   %%结第二周期</span><br><span class="line">Tt3=0.275;   %%结构第三周期</span><br><span class="line">%%</span><br><span class="line">S=zeros(301,1);</span><br><span class="line">T=zeros(301,1);</span><br><span class="line">abc=zeros(n,5);</span><br><span class="line">%% fname为输入文件名，从PEER网站下载的地震加速度记录</span><br><span class="line">for j=1:n</span><br><span class="line">fname=char(filenames1(j));</span><br><span class="line">fin=fopen(fname,&#x27;r&#x27;);</span><br><span class="line">  for m=1:4</span><br><span class="line">    str = fgetl(fin);%the first 3 loops are meant be skiped.</span><br><span class="line">  end</span><br><span class="line">Par=textscan(str, &#x27;%*s %f %*s %f %*s&#x27;,&#x27;delimiter&#x27;,&#x27;=&#x27;);</span><br><span class="line">NPTS=Par&#123;1&#125;;DT=Par&#123;2&#125;;</span><br><span class="line">abc(j,2)=NPTS;</span><br><span class="line">abc(j,3)=DT;</span><br><span class="line">LINES = (floor(NPTS/5)+1);</span><br><span class="line">Acc = [];</span><br><span class="line">    for k = 1:LINES</span><br><span class="line">     str = fgetl(fin);</span><br><span class="line">         if(str ~= -1) % 判断读取结果是否有效</span><br><span class="line">         P = sscanf(str,&#x27;%f&#x27;);</span><br><span class="line">         Acc = [Acc;P];</span><br><span class="line">         end</span><br><span class="line">    end    </span><br><span class="line">[aa,bb]=max(abs(Acc));</span><br><span class="line">abc(j,4)=aa;     %%每条地震波原始的PGA</span><br><span class="line">abc(j,5)=PGA/aa;</span><br><span class="line">Acc=PGA/aa*Acc;  %%每条地震波PGA调幅</span><br><span class="line">%%</span><br><span class="line">     for l=0:1:300;  %%0-6s共301个点</span><br><span class="line">        i=l*0.02;</span><br><span class="line">        T(l+1,1) = i;</span><br><span class="line">        S(l+1,1) = Newmark(Acc,DT,i,0.03,1); </span><br><span class="line">     end</span><br><span class="line"> S1= [S1;S];</span><br><span class="line">sta=fclose(fin);</span><br><span class="line">end</span><br><span class="line">S2=reshape(S1,301,n);   %%每条地震波的加速度反应谱</span><br><span class="line">%%</span><br><span class="line">aaa=num2cell(abc);</span><br><span class="line">for q=1:n</span><br><span class="line">    aaa(q,1)=filenames(q);   %%输入地震波的信息</span><br><span class="line">end</span><br><span class="line">%%</span><br><span class="line">fname = &#x27;F:\1study\2earthquake\spectrum0.16.txt&#x27;;  %%读取设计反应谱</span><br><span class="line">fin=fopen(fname,&#x27;r&#x27;);</span><br><span class="line">A1 = importdata(fname);</span><br><span class="line">sta=fclose(fin);</span><br><span class="line">%%</span><br><span class="line">%%控制段</span><br><span class="line">T0=0.1;</span><br><span class="line">Tg=0.35;</span><br><span class="line">deltaT1=0.2;</span><br><span class="line">deltaT2=0.5;</span><br><span class="line">kz1=round((Tg-T0)/0.02)+1;</span><br><span class="line">kz2=round((deltaT1+deltaT2)/0.02)+1;</span><br><span class="line">kz3=round((Tt1-0.2)/0.02)+1;</span><br><span class="line">kz=kz1+kz2;</span><br><span class="line">rsme=zeros(1,n);</span><br><span class="line">for i=1:n</span><br><span class="line">    kzz1=0;</span><br><span class="line">    kzz2=0;</span><br><span class="line">    for j=6:(kz1+5)</span><br><span class="line">        kzz1=kzz1+(S2(j,i)-A1(j))^2;</span><br><span class="line">    end</span><br><span class="line">    for j=kz3:(kz3+kz2-1)</span><br><span class="line">        kzz2=kzz2+(S2(j,i)-A1(j))^2;</span><br><span class="line">    end</span><br><span class="line">    rsme(i)=sqrt((kzz1+kzz2)/kz);         %%均方根误差</span><br><span class="line">end</span><br><span class="line">%%</span><br><span class="line">[rsme1,index1]=sort(rsme);        %%从小到大排序</span><br><span class="line">ts=10;              %%所选地震波条数</span><br><span class="line">output=cell(ts+1,6);     %%最终选波结果</span><br><span class="line">output(1,1)=cellstr(&#x27;地震名称&#x27;);</span><br><span class="line">output(1,2)=cellstr(&#x27;NPTS值&#x27;);</span><br><span class="line">output(1,3)=cellstr(&#x27;NT值&#x27;);</span><br><span class="line">output(1,4)=cellstr(&#x27;原PGA值&#x27;);</span><br><span class="line">output(1,5)=cellstr(&#x27;调幅因子&#x27;);</span><br><span class="line">output(1,6)=cellstr(&#x27;RMSE值&#x27;);</span><br><span class="line">%%</span><br><span class="line">rsme2=num2cell(rsme);</span><br><span class="line">S3=zeros(301,ts);</span><br><span class="line">for i=1:ts</span><br><span class="line">    S3(:,i)=S2(:,index1(i));</span><br><span class="line">    output(i+1,1)=aaa(index1(i),1);   %%地震名称</span><br><span class="line">    output(i+1,2)=aaa(index1(i),2);   %%NPTS值</span><br><span class="line">    output(i+1,3)=aaa(index1(i),3);   %%NT值</span><br><span class="line">    output(i+1,4)=aaa(index1(i),4);   %%原PGA值</span><br><span class="line">    output(i+1,5)=aaa(index1(i),5);   %%调幅因子</span><br><span class="line">    output(i+1,6)=rsme2(index1(i));   %%RMSE值</span><br><span class="line">end</span><br><span class="line">%%</span><br><span class="line">% plot(T,S2)  %%画所有反应谱曲线</span><br><span class="line">plot(T,S3)  %%画选择后的反应谱曲线</span><br><span class="line">hold on</span><br><span class="line">plot(T,A1,&#x27;k&#x27;,&#x27;LineWidth&#x27;,2)  %%画设计反应谱曲线</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/07/19/%E5%8F%8C%E9%A2%91%E6%AE%B5%E9%80%89%E6%B3%A2%E6%96%B9%E6%B3%95/" data-id="claqum2e60023h0tk4ncjg51q" data-title="双频段选波方法" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-sap2000之VBA二次开发" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/07/19/sap2000%E4%B9%8BVBA%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91/" class="article-date">
  <time class="dt-published" datetime="2022-07-19T14:44:10.000Z" itemprop="datePublished">2022-07-19</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/07/19/sap2000%E4%B9%8BVBA%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91/">sap2000之VBA二次开发</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>经过看几篇推送文，然后自己也是模仿别人的路径在走，也算学有所得。<br>主要是是掌握了以下的几个内容：</p>
<ol>
<li>打开已有的sap2000文件</li>
<li>建立一个特定的构件</li>
<li>施加荷载</li>
<li>查看结果</li>
</ol>
<p>实际操作的时候有一个非常好的例子值得借鉴，后续如果自己想往这个方面去深究的话倒是一个很好的方向，值得自己去研究一下。<br>以一个二维的框架为例子进行相应的例子分析，其中数据表有两个方式，一个是用里面自带的显示表的位移，一个是用excel的形式，导出来。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/07/19/sap2000%E4%B9%8BVBA%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91/" data-id="claqum2dr0017h0tk5keu30yk" data-title="sap2000之VBA二次开发" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-python二次开发cad" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/07/15/python%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91cad/" class="article-date">
  <time class="dt-published" datetime="2022-07-15T00:00:23.000Z" itemprop="datePublished">2022-07-15</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/07/15/python%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91cad/">python二次开发cad</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>将cad的坐标数据写入excel中<br>用到了两个库：pyautocad 和openpyxl</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/07/15/python%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91cad/" data-id="claqum2do0011h0tk8n9zcufc" data-title="python二次开发cad" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-sap2000之python二次开发" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/07/04/sap2000%E4%B9%8Bpython%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91/" class="article-date">
  <time class="dt-published" datetime="2022-07-04T15:43:41.000Z" itemprop="datePublished">2022-07-04</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/07/04/sap2000%E4%B9%8Bpython%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91/">sap2000之python二次开发</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>慢慢来吧，有空的时候就整，这肯定也是一个比较好的方向，值得自己去积累与深挖的方向，并且自己要形成一些相应的标准文件来巩固自己所学。</p>
<p>通过api，用户可以编写程序控制sap2000，调用软件中的各种功能，实现<strong>自动建模</strong>、<strong>自动分析</strong>、<strong>自动调整参数</strong>、<strong>迭代运行</strong>，而且自己也一直在不停的往前学，往深的方向进行专研。</p>
<p>pywin32库<br>为python提访问windows api的扩展，提供了非常完整的<strong>window常量</strong>、<strong>接口</strong>、<strong>线程</strong>以及<strong>com机制</strong></p>
<h1 id="系统单位值："><a href="#系统单位值：" class="headerlink" title="系统单位值："></a>系统单位值：</h1><p>备注：主要有16种方式，在平时的使用种主要用到的是这样的几种：5、6、9、10<br>lb_in_F &#x3D; 1<br>lb_ft_F &#x3D; 2<br>kip_in_F &#x3D; 3<br>kip_ft_F &#x3D; 4<br>kN_mm_C &#x3D; 5<br>kN_m_C &#x3D; 6<br>kgf_mm_C &#x3D; 7<br>kgf_m_C &#x3D; 8<br>N_mm_C &#x3D; 9<br>N_m_C &#x3D; 10<br>Ton_mm_C &#x3D; 11<br>Ton_m_C &#x3D; 12<br>kN_cm_C &#x3D; 13<br>kgf_cm_C &#x3D; 14<br>N_cm_C &#x3D; 15<br>Ton_cm_C &#x3D; 16</p>
<h1 id="访问sap2000"><a href="#访问sap2000" class="headerlink" title="访问sap2000"></a>访问sap2000</h1><p>根据自己的整理，这里主要提供了以下的两种方式：<br><strong>方式一：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># os模块负责程序与操作系统的交互，提供了访问操作系统底层的接口</span></span><br><span class="line"><span class="comment"># This module provides a portable way of using operating system dependent functionality.</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="comment"># sys模块负责程序与python解释器的交互，提供了一系列的函数和变量，用于操控python的运行时环境</span></span><br><span class="line"><span class="comment"># This module provides access to some variables used or maintained by the interpreter and to functions that interact strongly with the interpreter</span></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> comtypes.client</span><br><span class="line"><span class="comment"># comtypes包是纯python，轻量级的COM客户端和服务框架，基于ctypes的Python的FFI包，可以在python的环境中使用该包的各类模块</span></span><br><span class="line"><span class="keyword">import</span> comtypes</span><br><span class="line"></span><br><span class="line"><span class="comment"># 首先根据类名建立COM对象，SAP2000的类名为SAP2000v1.Helper</span></span><br><span class="line"><span class="comment"># creat_com_object</span></span><br><span class="line">helper = comtypes.client.CreateObject(<span class="string">&#x27;SAP2000v1.Helper&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1.根据路径来运行</span></span><br><span class="line"><span class="comment"># 使用函数CreateObject打开软件</span></span><br><span class="line">ProgramPath = <span class="string">&#x27;D:\Program Files\Computers and Structures\SAP2000 24\SAP2000.exe&#x27;</span></span><br><span class="line">mySapObject = helper.CreateObject(ProgramPath)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.根据程序ID打开软件</span></span><br><span class="line">mySapObject = helper.CreateObjectProgID(<span class="string">&quot;CSI.SAP2000.API.SapObject&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用ApplicationStart函数运行SAP2000软件，并指定单位制</span></span><br><span class="line">mySapObject.ApplicationStart(<span class="number">9</span>)</span><br><span class="line">SapModel = mySapObject.SapModel</span><br></pre></td></tr></table></figure>
<p><strong>方式二</strong>：其实差不多，可能是写法略微有点区别</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> comtypes.client</span><br><span class="line"><span class="keyword">import</span> comtypes</span><br><span class="line"></span><br><span class="line">helper = comtypes.client.CreateObject(<span class="string">&#x27;CSiAPIv1.Helper&#x27;</span>)</span><br><span class="line">mySapObject = helper.CreateObject(<span class="string">r&quot;D:\Program Files\Computers and Structures\SAP2000 24\SAP2000.exe&quot;</span>)</span><br><span class="line"><span class="comment">#mySapObject = helper.CreateObjectProgID(&quot;CSI.SAP2000.API.SapObject&quot;)</span></span><br><span class="line"></span><br><span class="line">mySapObject.ApplicationStart()</span><br><span class="line">SapModel = mySapObject.SapModel</span><br></pre></td></tr></table></figure>


<p>以下为一些非常简单的常规操作，也作为一个平时的记录点写下来，方便后面自己来查阅，侧重点是代码的理解与运行，并且都是自己调试过的，也大致能够理解的，能够有一些相应的实际意义的。</p>
<h1 id="定义材料与截面"><a href="#定义材料与截面" class="headerlink" title="定义材料与截面"></a>定义材料与截面</h1><h2 id="定义材料"><a href="#定义材料" class="headerlink" title="定义材料"></a>定义材料</h2><p>在CSI_OAPI_Documentation开发文件中的CSI OAPI Functions-Definitions-Properties-Material中查看材料定义相关的函数<br>对于几种材料的编号要清楚：</p>
<ol>
<li>MATERIAL_STEEL(钢材)</li>
<li>MATERIAL_CONCRETE(混凝土)</li>
<li>MATERIAL_NODESIGN(自定义)</li>
<li>MATERIAL_ALUMINUM(铝合金)</li>
<li>MATERIAL_COLDFORMED(冷弯薄壁型钢)</li>
<li>MATERIAL_REBAR(钢筋)</li>
<li>MATERIAL_TENDON(钢索)</li>
</ol>
<p>使用SapModel.PropMaterial.AddMaterial函数添加材料，例如添加C20混凝土</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">name=<span class="string">&quot;&quot;</span></span><br><span class="line">name,ret=SapModel.PropMaterial.AddMaterial(name,<span class="number">2</span>,<span class="string">&quot;&quot;</span>china,<span class="string">&quot;GB&quot;</span>,<span class="string">&quot;GB50010 C20&quot;</span> )</span><br></pre></td></tr></table></figure>
<p>该函数主要有6个参数：Name,MatType,Region,Standard,Grade,UserName</p>
<ol>
<li>Name为返回的材料名，为ByRef类型，该参数要按照引用的方式传递，在函数中修改这个值会造成实参的值发生相应的改变</li>
<li>MatType为材料类型</li>
<li>Region,Standard,Grade为一些材料的具体参数</li>
<li>UserName 为用户指定的材料名，为可选参数(Optional ByVal),如果不传递就会使用默认值</li>
</ol>
<p>如果添加多种材料，可以使用循环语句：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">names = [<span class="string">&quot;Q235&quot;</span>,<span class="string">&quot;Q355&quot;</span>,<span class="string">&quot;Q420&quot;</span>,<span class="string">&quot;Q460&quot;</span>]</span><br><span class="line"><span class="keyword">for</span> mname <span class="keyword">in</span> names:</span><br><span class="line">    name,ret=SapModel.PropMaterial.AddMaterial(name,<span class="number">1</span>,<span class="string">&quot;china&quot;</span>,<span class="string">&quot;GB&quot;</span>,mname)</span><br></pre></td></tr></table></figure>
<h2 id="添加截面"><a href="#添加截面" class="headerlink" title="添加截面"></a>添加截面</h2><p>在CSI_OAPI_Documentation开发文件中的CSi OAPI Functions-Definitions-Properties-Frame中查看框架截面定义相关的函数。<br>通过API函数可以查询当前模型定义的截面、添加截面以及修改截面</p>
<h3 id="混凝土截面添加"><a href="#混凝土截面添加" class="headerlink" title="混凝土截面添加"></a>混凝土截面添加</h3><p>矩形：SetRecangle函数<br>圆形：SetCircle函数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SapModel.PropFrame.SetRectangle(<span class="string">&quot;Beam500x300&quot;</span>,<span class="string">&quot;C30&quot;</span>,<span class="number">0.5</span>,<span class="number">0.3</span>)</span><br><span class="line">SapModel.PropFrame,SetRecTangle(<span class="string">&quot;Col500x300&quot;</span>,<span class="string">&quot;C30&quot;</span>,<span class="number">0.5</span>,<span class="number">0.5</span>)</span><br><span class="line"><span class="comment"># 混凝土的配筋信息使用SetRebarBeam和SetRebarColumn函数</span></span><br><span class="line">SapModel.PropFrame.SetRebarBeam(<span class="string">&quot;Beam500X300&quot;</span>,<span class="string">&quot;HPB300&quot;</span>,<span class="string">&quot;HPB300&quot;</span>,<span class="number">0.002</span>,<span class="number">0.002</span>,<span class="number">0.00005</span>,<span class="number">0.00005</span>,<span class="number">0.00005</span>,<span class="number">0.00005</span>)</span><br><span class="line">SapModel.PropFrame.SetRebarColumn(<span class="string">&quot;Col500X500&quot;</span>,<span class="string">&quot;HPB300&quot;</span>,<span class="string">&quot;HPB300&quot;</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0.02</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="string">&quot;10d&quot;</span>,<span class="string">&quot;10d&quot;</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>
<h3 id="钢结构截面的定义"><a href="#钢结构截面的定义" class="headerlink" title="钢结构截面的定义"></a>钢结构截面的定义</h3><h4 id="型钢库截面导入"><a href="#型钢库截面导入" class="headerlink" title="型钢库截面导入"></a>型钢库截面导入</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 方法一：采用老版的pro格式的</span></span><br><span class="line">SapModel.PropFrame.ImportProp(<span class="string">&quot;L20X3&quot;</span>,<span class="string">&quot;Q235&quot;</span>,<span class="string">&quot;ChineseGB08.pro&quot;</span>,<span class="string">&quot;L20x3&quot;</span>)</span><br><span class="line"><span class="comment"># 方法二：采用新版的xml格式的</span></span><br><span class="line">ret = SapModel.PropFrame.ImportProp(<span class="string">&quot;L30X3&quot;</span>,<span class="string">&quot;Q235&quot;</span>,<span class="string">&quot;D:\Program Files\Computers and Structures\SAP2000 24\Property Libraries\Sections\ChineseGB08.xml&quot;</span>,<span class="string">&quot;L30X3&quot;</span>)</span><br></pre></td></tr></table></figure>
<h4 id="角钢截面"><a href="#角钢截面" class="headerlink" title="角钢截面"></a>角钢截面</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SapModel.PropFrame.SetAngle(<span class="string">&quot;L60X5&quot;</span>,<span class="string">&quot;Q235&quot;</span>,<span class="number">0.06</span>,<span class="number">0.06</span>,<span class="number">0.005</span>,<span class="number">0.005</span>)</span><br></pre></td></tr></table></figure>
<h4 id="圆管截面"><a href="#圆管截面" class="headerlink" title="圆管截面"></a>圆管截面</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SapModel.ProFrame.SetPipe(<span class="string">&quot;P100X2&quot;</span>,<span class="string">&quot;Q235&quot;</span>,<span class="number">100</span>,<span class="number">2</span>)</span><br></pre></td></tr></table></figure>

<h1 id="杆件绘制"><a href="#杆件绘制" class="headerlink" title="杆件绘制"></a>杆件绘制</h1><h2 id="采用点的方式"><a href="#采用点的方式" class="headerlink" title="采用点的方式"></a>采用点的方式</h2><p>在CSi OAPI Functions-Objects Model-Point object中查看Point绘制的函数</p>
<ol>
<li>SapModel.PointObj.AddCartesian</li>
<li>SapModel.PointObj.AddCylindrical</li>
<li>SapModel.PointObj.AddSpherical</li>
</ol>
<h3 id="按照笛卡尔坐标"><a href="#按照笛卡尔坐标" class="headerlink" title="按照笛卡尔坐标"></a>按照笛卡尔坐标</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Name = <span class="string">&quot;&quot;</span></span><br><span class="line">locZ = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> step <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    name,ret=SapModel.PointObj.AddCartesian(<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>+locZ*step,Name)</span><br></pre></td></tr></table></figure>
<p>其他的几种方式省略</p>
<h1 id="打开文件并获取杆件的数量以及标签"><a href="#打开文件并获取杆件的数量以及标签" class="headerlink" title="打开文件并获取杆件的数量以及标签"></a>打开文件并获取杆件的数量以及标签</h1><p>参考链接：<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/zn8QVG1aOtLgZD6swVdlTA">https://mp.weixin.qq.com/s/zn8QVG1aOtLgZD6swVdlTA</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> comtypes.client</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="comment"># 这里采用try except的方式就可以以两种方式打开sap2000，当目前有打开的sap2000时直接获取当前的COM对象，如果提示为&quot;OSError, comtypes.COMError&quot;，直接根据程序的地址来创建COM对象</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="comment">#获得当前运行的COM对象</span></span><br><span class="line">    mySapObject = comtypes.client.GetActiveObject(<span class="string">&#x27;CSI.SAP2000.API.SapObject&#x27;</span>)</span><br><span class="line"><span class="comment"># 如果当前没有运行的com对象，就直接打开sap2000程序</span></span><br><span class="line"><span class="keyword">except</span>(OSError, comtypes.COMError):</span><br><span class="line">    <span class="comment">#指定SAP2000运行地址</span></span><br><span class="line">    ProgramPath = <span class="string">&#x27;D:\Program Files\Computers and Structures\SAP2000 24\SAP2000.exe&#x27;</span></span><br><span class="line">    <span class="comment">#根据ID值创建COM对象，SAP2000ID值为SAP2000v1.Helper</span></span><br><span class="line">    helper = comtypes.client.CreateObject(<span class="string">&#x27;SAP2000v1.Helper&#x27;</span>)</span><br><span class="line">    <span class="comment">#查询目标接口</span></span><br><span class="line">    <span class="comment"># QueryInterface客户可以通过此函数来查询某个组件是否支持某个特定的接口</span></span><br><span class="line">    <span class="comment"># comtypes.gen是子包，导入comtypes.client会自动创建</span></span><br><span class="line">    helper = helper.QueryInterface(comtypes.gen.SAP2000v1.cHelper)</span><br><span class="line">    <span class="comment"># 采用指定运行路径的方式运行 SAP2000</span></span><br><span class="line">    <span class="comment"># 当所给定的路径不对的时候，程序也会报错，此时再嵌套一个try except语句，并打印&quot;当前的路径无法打开主程序&quot;</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        mySapObject = helper.CreateObject(ProgramPath)</span><br><span class="line">    <span class="keyword">except</span> (OSError, comtypes.COMError):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Cannot start a new instance of the program from &quot;</span> + ProgramPath)</span><br><span class="line">        <span class="comment"># 非正常退出程序</span></span><br><span class="line">        sys.exit(-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用ApplicationStart函数运行sap2000软件，并指定单位制（此处按的默认值）</span></span><br><span class="line">mySapObject.ApplicationStart()</span><br><span class="line"><span class="comment">#生成SapModel</span></span><br><span class="line">SapModel = mySapObject.SapModel</span><br><span class="line"><span class="comment">#模型文件</span></span><br><span class="line">FilePath = <span class="string">r&#x27;E:\光伏支架相关文档\贵州光伏\贵州光伏（导入截面）\贵州光伏（导入截面）.sdb&#x27;</span></span><br><span class="line"><span class="comment">#打开模型文件</span></span><br><span class="line">SapModel.File.OpenFile(FilePath)</span><br><span class="line"><span class="comment">##获得模型杆件数量并显示</span></span><br><span class="line">FrameNum = <span class="number">0</span></span><br><span class="line">NameList = []</span><br><span class="line">ret = <span class="number">1</span></span><br><span class="line">[FrameNum,NameList,ret] = SapModel.FrameObj.GetNameList(FrameNum,NameList)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;杆件总数：&quot;</span>,FrameNum)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;构件列表：\n&quot;</span>,NameList)</span><br><span class="line"><span class="built_in">input</span>(<span class="string">&quot;Press Any Key&quot;</span>)</span><br></pre></td></tr></table></figure>

<h1 id="运行sap2000软件，打开指定的模型文件，并读取模型中的构件数"><a href="#运行sap2000软件，打开指定的模型文件，并读取模型中的构件数" class="headerlink" title="运行sap2000软件，打开指定的模型文件，并读取模型中的构件数"></a>运行sap2000软件，打开指定的模型文件，并读取模型中的构件数</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> comtypes.client</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="comment">#获得当前运行的COM对象</span></span><br><span class="line">    mySapObject = comtypes.client.GetActiveObject(<span class="string">&#x27;CSI.SAP2000.API.SapObject&#x27;</span>)</span><br><span class="line"><span class="keyword">except</span>(OSError, comtypes.COMError):</span><br><span class="line">    <span class="comment">#指定SAP2000运行地址</span></span><br><span class="line">    ProgramPath = <span class="string">&#x27;D:\Program Files\Computers and Structures\SAP2000 24\SAP2000.exe&#x27;</span></span><br><span class="line">    <span class="comment">#根据ID值创建COM对象，SAP2000ID值为SAP2000v1.Helper</span></span><br><span class="line">    helper = comtypes.client.CreateObject(<span class="string">&#x27;SAP2000v1.Helper&#x27;</span>)</span><br><span class="line">    <span class="comment">#查询目标接口</span></span><br><span class="line">    helper = helper.QueryInterface(comtypes.gen.SAP2000v1.cHelper)</span><br><span class="line">    <span class="comment"># 采用指定运行路径的方式运行 SAP2000</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        mySapObject = helper.CreateObject(ProgramPath)</span><br><span class="line">    <span class="keyword">except</span> (OSError, comtypes.COMError):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Cannot start a new instance of the program from &quot;</span> + ProgramPath)</span><br><span class="line">        sys.exit(-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">mySapObject.ApplicationStart()</span><br><span class="line"><span class="comment">#生成SapModel</span></span><br><span class="line">SapModel = mySapObject.SapModel</span><br><span class="line"><span class="comment">#模型文件</span></span><br><span class="line">FilePath = <span class="string">r&#x27;E:\光伏支架相关文档\贵州光伏\贵州光伏（导入截面）\贵州光伏（导入截面）.sdb&#x27;</span></span><br><span class="line"><span class="comment">#打开模型文件</span></span><br><span class="line">SapModel.File.OpenFile(FilePath)</span><br><span class="line"><span class="comment">##获得模型杆件数量并显示</span></span><br><span class="line">FrameNum = <span class="number">0</span></span><br><span class="line">NameList = []</span><br><span class="line">ret = <span class="number">1</span></span><br><span class="line">[FrameNum,NameList,ret] = SapModel.FrameObj.GetNameList(FrameNum,NameList)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;杆件总数：&quot;</span>,FrameNum)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;构件列表：\n&quot;</span>,NameList)</span><br><span class="line"><span class="built_in">input</span>(<span class="string">&quot;Press Any Key&quot;</span>)</span><br></pre></td></tr></table></figure>
<h1 id="以一根梁为例进行分析"><a href="#以一根梁为例进行分析" class="headerlink" title="以一根梁为例进行分析"></a>以一根梁为例进行分析</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> comtypes.client</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取当前运行的sap2000</span></span><br><span class="line">SapObject = comtypes.client.GetActiveObject(<span class="string">&quot;CSI.SAP2000.API.SapObject&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#create SapModel object（创建模型对象）</span></span><br><span class="line">SapModel = SapObject.SapModel</span><br><span class="line"></span><br><span class="line"><span class="comment">#initialize model（初始化模型）</span></span><br><span class="line">SapModel.InitializeNewModel()</span><br><span class="line"></span><br><span class="line"><span class="comment">#create new blank model（创建新的空白模型）</span></span><br><span class="line">ret = SapModel.File.NewBlank()</span><br><span class="line">kN_mm_C = <span class="number">5</span></span><br><span class="line">ret = SapModel.SetPresentUnits(<span class="number">5</span>)  <span class="comment"># 设置模型单位</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加材料</span></span><br><span class="line">MATERIAL_STEEL=<span class="number">1</span> <span class="comment">#钢材</span></span><br><span class="line">MATERIAL_CONCRETE = <span class="number">2</span> <span class="comment">#混凝土</span></span><br><span class="line">MATERIAL_BEBAR = <span class="number">8</span> <span class="comment"># 钢筋</span></span><br><span class="line">mat=<span class="string">&quot;C40&quot;</span></span><br><span class="line">ret = SapModel.PropMaterial.AddMaterial(mat,<span class="number">2</span>,<span class="string">&quot;china&quot;</span>,<span class="string">&quot;GB&quot;</span>,<span class="string">&quot;GB50010 C40&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义框架截面属性</span></span><br><span class="line">sec = <span class="string">&quot;300x700&quot;</span></span><br><span class="line">ret = SapModel.PropFrame.SetRectangle(sec,<span class="string">&quot;C40&quot;</span>,<span class="number">700</span>,<span class="number">300</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 布置框架截面</span></span><br><span class="line">x1,y1,z1=<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span></span><br><span class="line">x2,y2,z2=<span class="number">5000</span>,<span class="number">0</span>,<span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 建立一根跨度为5m的梁</span></span><br><span class="line">SapModel.FrameObj.AddByCoord(x1,y1,z1,x2,y2,z2,<span class="string">&quot;L1&quot;</span>,sec,<span class="string">&quot;L1&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加支座约束</span></span><br><span class="line">Restraint=[<span class="literal">True</span>,<span class="literal">True</span>,<span class="literal">True</span>,<span class="literal">False</span>,<span class="literal">False</span>,<span class="literal">False</span>] <span class="comment"># 三平动，三转动，此处为简支梁</span></span><br><span class="line">PointName1=<span class="string">&quot; &quot;</span></span><br><span class="line">PointName2=<span class="string">&quot; &quot;</span></span><br><span class="line">[PointName1,PointName2,ret]=SapModel.Frameobj.GetPoints(<span class="string">&quot;L1&quot;</span>,PointName1,PointName2)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 简支梁支座（给两个节点添加设置好的支座）</span></span><br><span class="line">SapModel.PointObj.SetRestraint(PointName1,Restraint)</span><br><span class="line">SapModel.PointObj.SetRestraint(PointName2,Restraint)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义荷载模式 常用的如下：</span></span><br><span class="line"><span class="comment"># DEAD=1(默认已有) SUPERDEAD(附加恒载)=2，活载2，地震荷载5，用于底部剪力法，按照多质点算的</span></span><br><span class="line"><span class="comment"># 风荷载6，雪荷载7，屋面活荷载11，移动荷载9，温度荷载10</span></span><br><span class="line">LTYPE_DEAD=<span class="number">1</span> <span class="comment"># 恒载</span></span><br><span class="line">LTYPE_LIVE=<span class="number">3</span> <span class="comment"># 活荷载</span></span><br><span class="line">SapModel.LoadPatterns.Add(<span class="string">&quot;DEAD1&quot;</span>,LTYPE_DEAD,<span class="number">0</span>,<span class="literal">True</span>)</span><br><span class="line">SapModel.LoadPatterns.Add(<span class="string">&quot;Live&quot;</span>,LTYPE_LIVE,<span class="number">0</span>,<span class="literal">False</span>) <span class="comment"># 自重系数0，flase:不创建荷载工况</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加荷载</span></span><br><span class="line">kN_m_C=<span class="number">6</span></span><br><span class="line">ret = SapModel.SetPresentUnits(<span class="number">6</span>)</span><br><span class="line">SapModel.FrameObj.SetLoadGravity(<span class="string">&quot;L1&quot;</span>,<span class="string">&quot;DEAD1&quot;</span>,<span class="number">0</span>,<span class="number">0</span>,-<span class="number">10</span>,<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 保存模型</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># path=&quot;E:\GHtosap2000\Example2&quot;</span></span><br><span class="line"><span class="comment"># ModelPath = path +os.sep + &quot;test01.sdb&quot;</span></span><br><span class="line"><span class="comment"># SapModel.File.Save(ModelPath)</span></span><br><span class="line">path=<span class="string">r&#x27;E:\GHtosap2000\Example1\test01.sdb&#x27;</span></span><br><span class="line">SapModel.File.Save(path)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 分析模型</span></span><br><span class="line">SapModel.Analyze.RunAnalysis()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 结果查看</span></span><br><span class="line">SapResult = [<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line">[PointName1,PointName2,ret] = SapModel.FrameObj.GetPoints(<span class="string">&quot;L1&quot;</span>,PointName1,PointName2)</span><br><span class="line">SapModel.Results.Setup.DeselectAllCasesAndCombosForOutput()  <span class="comment"># 取消选择所有工况输出</span></span><br><span class="line">SapModel.Results.Setup.GetCaseSelectedForOutput(<span class="string">&quot;DEAD1&quot;</span>) <span class="comment"># 选择dead1工况进行输出</span></span><br><span class="line">ret = SapModel.Results.Setup.SetCaseSelectedForOutput(<span class="string">&quot;DEAD1&quot;</span>)</span><br><span class="line">NumberResults=<span class="number">0</span></span><br><span class="line">Obj,Elm,LoadCase,StepType,StepNum,F1,F2,F3,M1,M2,M3,=[],[],[],[],[],[],[],[],[],[],[]</span><br><span class="line">[NumberResults, Obj, Elm, LoadCase, StepType, StepNum, F1, F2, F3, M1, M2, M3,ret] = SapModel.Results.JointReact(PointName1,<span class="number">0</span>,NumberResults, Obj, Elm, LoadCase, StepType, StepNum, F1, F2, F3, M1, M2, M3)</span><br><span class="line"><span class="built_in">print</span>(F2)</span><br><span class="line"><span class="comment"># 关闭sap2000</span></span><br><span class="line"><span class="comment"># SapModel.ApplicationExit(True) # 关闭sap2000</span></span><br><span class="line">SapModel = <span class="number">0</span></span><br><span class="line">SapObject = <span class="number">0</span> <span class="comment"># 不设置成0应用程序没有完全关闭，仍然占用系统内存</span></span><br></pre></td></tr></table></figure>

<h1 id="运用python调用sap2000分析一根跨度为6m的梁-非解构"><a href="#运用python调用sap2000分析一根跨度为6m的梁-非解构" class="headerlink" title="运用python调用sap2000分析一根跨度为6m的梁(非解构)"></a>运用python调用sap2000分析一根跨度为6m的梁(非解构)</h1><p>参考链接：<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s?__biz=MzU0Nzc5MDQxNw==&amp;mid=2247493688&amp;idx=1&amp;sn=d5dae0cc6d51cfae44f3ce46a9c0be68&amp;chksm=fb4ba306cc3c2a101eefeaeda634f2b13b5ac3e409af8b43fda65a1dc72fade9667306b1a7bf&amp;cur_album_id=1323908580084449280&amp;scene=190#rd">https://mp.weixin.qq.com/s?__biz=MzU0Nzc5MDQxNw==&amp;mid=2247493688&amp;idx=1&amp;sn=d5dae0cc6d51cfae44f3ce46a9c0be68&amp;chksm=fb4ba306cc3c2a101eefeaeda634f2b13b5ac3e409af8b43fda65a1dc72fade9667306b1a7bf&amp;cur_album_id=1323908580084449280&amp;scene=190#rd</a><br>备注：我认为这个简单的例子还是非常有实际的意义的，也是一个分析的出发点，而且里面还带有迭代的思想在里面，值得自己先把这些比较小的例子先吃透再来去看那些相对比较复杂的模型的分析，也希望自己能够不断的往前迈出大的步子。相较上一个例子，这一个例子写的就稍微的简练一点并且通用性和迭代性都会强一些。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> comtypes.client</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Caculation</span>(<span class="params">SapModel,depth,force_z</span>):</span><br><span class="line">    <span class="comment">#新建SAP2000模型（初始化模型-创建空白模板）</span></span><br><span class="line">    SapModel.InitializeNewModel()</span><br><span class="line">    ret = SapModel.File.NewBlank()</span><br><span class="line"></span><br><span class="line">    <span class="comment">#定义材料</span></span><br><span class="line">    <span class="comment">#AddMaterial</span></span><br><span class="line">    SapModel.PropMaterial.AddMaterial(<span class="string">&quot;C40&quot;</span>,<span class="number">2</span>,<span class="string">&quot;China&quot;</span>,<span class="string">&quot;GB&quot;</span>,<span class="string">&quot;GB50010 C40&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#定义截面</span></span><br><span class="line">    <span class="comment">#SetRectangle</span></span><br><span class="line">    SapModel.PropFrame.SetRectangle(<span class="string">&quot;Frame&quot;</span>,<span class="string">&quot;C40&quot;</span>,depth,<span class="number">400</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#建立模型</span></span><br><span class="line">    <span class="comment">#AddByCoord</span></span><br><span class="line">    <span class="comment"># 用笛卡尔坐标系建立了两个单元，都赋予了Frame截面</span></span><br><span class="line">    SapModel.FrameObj.AddByCoord(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">3000</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="string">&quot;element1&quot;</span>,<span class="string">&quot;Frame&quot;</span>,<span class="string">&quot;element1&quot;</span>)</span><br><span class="line">    SapModel.FrameObj.AddByCoord(<span class="number">3000</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">6000</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="string">&quot;element2&quot;</span>,<span class="string">&quot;Frame&quot;</span>,<span class="string">&quot;element2&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#添加约束</span></span><br><span class="line">    <span class="comment">#GetPoints</span></span><br><span class="line">    <span class="comment">#setRestraint</span></span><br><span class="line">    s_Point1=<span class="string">&quot;&quot;</span></span><br><span class="line">    e_Point1=<span class="string">&quot;&quot;</span></span><br><span class="line">    [s_Point1,e_Point1,ret]=SapModel.FrameObj.GetPoints(<span class="string">&quot;element1&quot;</span>,s_Point1,e_Point1)</span><br><span class="line"></span><br><span class="line">    s_Point2=<span class="string">&quot;&quot;</span></span><br><span class="line">    e_Point2=<span class="string">&quot;&quot;</span></span><br><span class="line">    [s_Point2,e_Point2,ret]=SapModel.FrameObj.GetPoints(<span class="string">&quot;element2&quot;</span>,s_Point2,e_Point2)</span><br><span class="line"></span><br><span class="line">    R=[<span class="literal">True</span>,<span class="literal">True</span>,<span class="literal">True</span>,<span class="literal">True</span>,<span class="literal">True</span>,<span class="literal">True</span>]</span><br><span class="line">    SapModel.PointObj.setRestraint(s_Point1,R)</span><br><span class="line">    SapModel.PointObj.setRestraint(e_Point2,R)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#添加荷载</span></span><br><span class="line">    SapModel.LoadPatterns.Add(<span class="string">&quot;Live&quot;</span>,<span class="number">3</span>)</span><br><span class="line">    <span class="comment"># 此处荷载添加竖向的荷载，用froce_z代替</span></span><br><span class="line">    Load=[<span class="number">0</span>,<span class="number">0</span>,force_z,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line">    <span class="comment"># 将荷载施加在单元1的J端</span></span><br><span class="line">    SapModel.PointObj.SetLoadForce(e_Point1, <span class="string">&quot;Live&quot;</span>, Load)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#保存模型（自定义一个路径）</span></span><br><span class="line">    path=<span class="string">r&#x27;E:\GHtosap2000\Example2\test02.sdb&#x27;</span></span><br><span class="line">    SapModel.File.Save(path)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#运行分析</span></span><br><span class="line">    SapModel.Analyze.RunAnalysis()</span><br><span class="line"></span><br><span class="line">    <span class="comment">#提取结果</span></span><br><span class="line">    <span class="comment"># 取消勾选所有工况和荷载组合</span></span><br><span class="line">    SapModel.Results.Setup.DeselectAllCasesAndCombosForOutput()</span><br><span class="line">    <span class="comment"># 选择Live组合作为结果输出</span></span><br><span class="line">    ret = SapModel.Results.Setup.SetCaseSelectedForOutput(<span class="string">&quot;Live&quot;</span>)</span><br><span class="line">    NumberResults=<span class="number">0</span></span><br><span class="line">    Obj, Elm, LoadCase, StepType, StepNum, F1, F2, F3, M1, M2, M3=[],[],[],[],[],[],[],[],[],[],[]</span><br><span class="line">    <span class="comment"># 提取节点反力 </span></span><br><span class="line">    <span class="comment">#NumberResults：程序返回的结果总数</span></span><br><span class="line">    <span class="comment">#Obj：与每一个结果关联的点对象的名称组成的数组，如果没有关联就默认为0</span></span><br><span class="line">    <span class="comment">#Elm：包含与每个结果关联的点元素名称的数组</span></span><br><span class="line">    <span class="comment">#LoadCase:包含与每个结果关联的分析工况和荷载组合的数组</span></span><br><span class="line">    <span class="comment">#StepType:包含结果每个步骤的数组</span></span><br><span class="line">    <span class="comment">#StepNum:包含每个结果步骤的编号的数组</span></span><br><span class="line">    <span class="comment">#F1,F2,F3：点在局部1 2 3轴的反作用组成的一维数组</span></span><br><span class="line">    <span class="comment">#M1 M2 M3:点在局部1 2 3轴的反作用矩组成的一维数组</span></span><br><span class="line"></span><br><span class="line">    [NumberResults, Obj, Elm, LoadCase, StepType, StepNum, F1, F2, F3, M1, M2, M3,ret] = SapModel.Results.JointReact(s_Point1, <span class="number">0</span>, NumberResults, Obj, Elm, LoadCase, StepType, StepNum, F1, F2, F3, M1, M2, M3)</span><br><span class="line">    <span class="comment"># 由于只关心反作用力，所以就只用打印三个反作用的数值</span></span><br><span class="line">    <span class="built_in">print</span>(F1)</span><br><span class="line">    <span class="built_in">print</span>(F2)</span><br><span class="line">    <span class="built_in">print</span>(F3)</span><br><span class="line"></span><br><span class="line"><span class="comment">#获取SAP2000对象</span></span><br><span class="line">mySapObject = comtypes.client.GetActiveObject(<span class="string">&quot;CSI.SAP2000.API.SapObject&quot;</span>)</span><br><span class="line">SapModel = mySapObject.SapModel</span><br><span class="line">depths=[<span class="number">500</span>,<span class="number">600</span>,<span class="number">700</span>,<span class="number">800</span>]</span><br><span class="line">force_zs=[<span class="number">1000</span>,<span class="number">2000</span>,<span class="number">3000</span>,<span class="number">4000</span>]</span><br><span class="line"><span class="comment"># 修改矩形截面的高度和施加的荷载值分别循环打印以下的一些结果</span></span><br><span class="line"><span class="comment"># 当截面为500x400,施加的力为1000</span></span><br><span class="line"><span class="comment"># 当截面为600x400，施加的力为2000</span></span><br><span class="line"><span class="comment"># 当截面为700x400，施加的力为3000</span></span><br><span class="line"><span class="comment"># 当截面为800x400，施加的力为4000</span></span><br><span class="line"><span class="keyword">for</span> i,depth <span class="keyword">in</span> <span class="built_in">enumerate</span>(depths):</span><br><span class="line">    force_z=force_zs[i]</span><br><span class="line">    Caculation(SapModel,depth,force_z)</span><br></pre></td></tr></table></figure>

<h1 id="Sap2000自带的python的例子"><a href="#Sap2000自带的python的例子" class="headerlink" title="Sap2000自带的python的例子"></a>Sap2000自带的python的例子</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 这个例子是sap2000种自带的例子，可以说是一个入门的例子</span></span><br><span class="line"><span class="comment"># 对里面的一些语法值得去推敲然后触类旁通，对其他的一些相应的概念进行扩展开来，对自己后面的深入学习肯定是有帮助的。</span></span><br><span class="line"><span class="keyword">import</span> os </span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> comtypes.client</span><br><span class="line"></span><br><span class="line"><span class="comment"># set the following flag to True to attach to an existing instance of the program</span></span><br><span class="line"><span class="comment"># 将以下的标志设置为True附加到现有的程序实例中来</span></span><br><span class="line"><span class="comment"># otherwise a new instance of the program will be started</span></span><br><span class="line"><span class="comment"># 否则程序将启动新的实例</span></span><br><span class="line">AttachToInstance = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># set the follwwing flag to True to manually specify the path to SAP2000.exe</span></span><br><span class="line"><span class="comment"># 将以下的标志设置为True来手动指定SAP2000.exe的路径</span></span><br><span class="line"><span class="comment"># this allows for a connection to a version of SAP200 other than the latest installation</span></span><br><span class="line"><span class="comment"># 这允许连接到除最新安装之外的sap2000版本</span></span><br><span class="line"><span class="comment"># otherwise the latest instaslled version of SAP2000 will be launched</span></span><br><span class="line"><span class="comment"># 否则将启动最新版本的安装</span></span><br><span class="line">SpecifyPath = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># if the above flag is set to True,specify the path to SAP2000.exe</span></span><br><span class="line"><span class="comment"># this allows for a connection to a version of SAP2000 other than the latest installation</span></span><br><span class="line"><span class="comment"># 如果上面的标志是True，就指定sap2000程序的运行路径，允许连接到除最新安装之外的sap2000的版本</span></span><br><span class="line">ProgramPath = <span class="string">&#x27;D:\Program Files\Computers and Structures\SAP2000 24\SAP2000.exe&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># full path to the model 模型的完整路径</span></span><br><span class="line"><span class="comment"># set it to the desired path of your model  将其设置为模型的所需路径</span></span><br><span class="line">APIPath = <span class="string">&#x27;C:\CSiAPIexample&#x27;</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(APIPath):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># 用于递归创建目录，如果子目录创建失败或者已经存在，会抛出一个OSError的异常</span></span><br><span class="line">        os.makedirs(APIPath)</span><br><span class="line">    <span class="keyword">except</span> OSError:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">ModelPath = APIPath + os.sep + <span class="string">&#x27;API_1-001.sdb&#x27;</span></span><br><span class="line"><span class="comment"># creat API helper object 创建API的辅助对象</span></span><br><span class="line">helper = comtypes.client.CreateObject(<span class="string">&#x27;SAP2000v1.Helper&#x27;</span>)</span><br><span class="line">helper = helper.QueryInterface(comtypes.gen.SAP2000v1.cHelper)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> AttachToInstance:</span><br><span class="line">    <span class="comment"># attach to a running instance of SAP2000</span></span><br><span class="line">    <span class="comment"># 附加到正在运行的sap2000实例中</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># get the active SapObject 获取当前运行的sap2000的进程，其中函数参数为programID</span></span><br><span class="line">        <span class="comment"># 对于sap2000v23版本，这个参数为CSI.SAP2000.API.SapObject</span></span><br><span class="line">        mySapObject = helper.Getobject(<span class="string">&quot;CSI.SAP2000.API.SapObject&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span> (OSError,comtypes.COMError):</span><br><span class="line">        <span class="comment"># 找不到正在运行的程序实例，或未能附加</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;No running instance of the program found or failed to attach.&quot;</span>)</span><br><span class="line">        <span class="comment"># 所有程序（方法、类等）停止，系统停止运行（主要用于含有多个类和方法并且相应的调用关系比较复杂的情况）</span></span><br><span class="line">        sys.exit(-<span class="number">1</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="comment"># 没有正在运行的实例，需要启动新的sap2000,主要有以下的两种方式</span></span><br><span class="line">    <span class="comment"># 1、使用函数helper.CreateObject(ProgramPath),根据exe文件路径建立SapObject实例，参数为exe文件的路径</span></span><br><span class="line">    <span class="comment"># 2、也可以使用helper.CreateObjectProgID(&quot;CSI.SAP2000.API.SapObject&quot;)函数根据软件的program ID启动建立SapObject实例</span></span><br><span class="line">    <span class="comment"># 下面的if 和else语句就是体现的两种不同的打开新的sap2000的方式，其中每一种方式都嵌套了一个try...except语句</span></span><br><span class="line">    <span class="comment"># 目的是为了告诉程序出现异常应该怎么做，即使是出现异常，程序也可以正常运行</span></span><br><span class="line">    <span class="keyword">if</span> SpecifyPath:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="comment"># create an instance of the SAPObject from the specified path</span></span><br><span class="line">            <span class="comment"># 1、使用函数helper.CreateObject(ProgramPath),根据exe文件路径建立SapObject实例，参数为exe文件的路径</span></span><br><span class="line">            mySapObject = helper.CreateObject(ProgramPath)</span><br><span class="line">        <span class="keyword">except</span> (OSError,comtypes.COMError):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Cannot start a new instance of the program from&quot;</span> + ProgramPath)</span><br><span class="line">            <span class="comment"># 打印：无法从ProgramPath启动程序的新实例</span></span><br><span class="line">            sys.exit(-<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="comment"># create an instance of the SAPObject from the latest installed SAP2000</span></span><br><span class="line">            <span class="comment"># 2、也可以使用helper.CreateObjectProgID(&quot;CSI.SAP2000.API.SapObject&quot;)函数根据软件的program ID启动建立SapObject实例</span></span><br><span class="line">            mySapObject = helper.CreateObjectProgID(<span class="string">&quot;CSI.SAP2000.API.SapObject&quot;</span>)</span><br><span class="line">        <span class="keyword">except</span> (OSError,comtypes.COMError):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Cannot start a new instance of the program.&quot;</span>)</span><br><span class="line">            <span class="comment"># 打印：无法启动程序的新实例</span></span><br><span class="line">            sys.exit(-<span class="number">1</span>)</span><br><span class="line">   </span><br><span class="line">        <span class="comment"># start SAP2000 application</span></span><br><span class="line">        <span class="comment"># 经过上面的步骤建立了SapObject实例之后，通过mySapObject.ApplicationStrat()函数启动SAP2000</span></span><br><span class="line">        mySapObject.ApplicationStart()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 以下的这三条代码基本上是一体的，在后面写代码的过程中可以在理解之后直接这样写   </span></span><br><span class="line"><span class="comment">#create SapModel object</span></span><br><span class="line">SapModel = mySapObject.SapModel</span><br><span class="line"></span><br><span class="line"><span class="comment"># initialize model</span></span><br><span class="line"><span class="comment"># 使用SapModel.InitializeNewModel()函数初始化模型（如果函数里面带有1~16的数字，就可以设置默认单位制，这里没有进行相应的设置）</span></span><br><span class="line">SapModel.InitializeNewModel()</span><br><span class="line"></span><br><span class="line"><span class="comment"># creat new blank model</span></span><br><span class="line"><span class="comment"># 创建一个空白的模型</span></span><br><span class="line">ret = SapModel.File.NewBlank()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># define material property</span></span><br><span class="line"><span class="comment"># 定义材料属性</span></span><br><span class="line">MATERIAL_CONCRETE = <span class="number">2</span></span><br><span class="line">ret = SapModel.PropMaterial.SetMaterial(<span class="string">&#x27;CONC&#x27;</span>,MATERIAL_CONCRETE)</span><br><span class="line"></span><br><span class="line"><span class="comment"># assign isotropic mechanical properties to material</span></span><br><span class="line"><span class="comment"># 将各项同性力学性能特性指定给材质，前面已经定义了CON截面，接下来的三个数分别是：弹性模量、泊松比以及热膨胀系数5.5e-6</span></span><br><span class="line">ret = SapModel.PropMaterial.SetMPIsotropic(<span class="string">&#x27;CONC&#x27;</span>,<span class="number">3600</span>,  <span class="number">0.2</span>, <span class="number">0.0000055</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义方形的截面属性，这里定义了截面为12inx12in的方形截面</span></span><br><span class="line"><span class="comment"># define rectangular frame section property</span></span><br><span class="line">ret = SapModel.PropFrame.SetRectangle(<span class="string">&#x27;R1&#x27;</span>,<span class="string">&#x27;CONC&#x27;</span>,<span class="number">12</span>,<span class="number">12</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义截面属性修正,这里模拟轴向刚度无穷大（将轴向面积设置为1000），并且忽略2、3轴的剪切变形（剪切面积为0）</span></span><br><span class="line"><span class="comment"># define frame section property modifiers</span></span><br><span class="line">ModValue = [<span class="number">1000</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>]</span><br><span class="line">ret = SapModel.PropFrame.SetModifiers(<span class="string">&#x27;R1&#x27;</span>,ModValue)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># switch to k-ft units</span></span><br><span class="line"><span class="comment"># 转换模型的单位</span></span><br><span class="line"><span class="comment"># 这种单位可能不是太常用，但是在很多的示例模型中是用的最多的</span></span><br><span class="line">kip_ft_F=<span class="number">4</span></span><br><span class="line">ret = SapModel.SetPresentUnits(kip_ft_F)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># add frame object by coordinates</span></span><br><span class="line"><span class="comment"># 通过坐标系来添加框架单元</span></span><br><span class="line"><span class="comment"># 这种操作是最基础也是最重要的一部分，这里主要有三根框架单元，这里是缺省的截面，自动赋予之前定义好的方管截面</span></span><br><span class="line">FrameName1 = <span class="string">&#x27; &#x27;</span></span><br><span class="line">FrameName2 = <span class="string">&#x27; &#x27;</span></span><br><span class="line">FrameName3 = <span class="string">&#x27; &#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[FrameName1,ret] = SapModel.FrameObj.AddByCoord(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">10</span>,FrameName1,<span class="string">&#x27;R1&#x27;</span>,<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;Global&#x27;</span>)</span><br><span class="line">[FrameName2,ret] = SapModel.FrameObj.AddByCoord(<span class="number">0</span>,<span class="number">0</span>,<span class="number">10</span>,<span class="number">8</span>,<span class="number">0</span>,<span class="number">16</span>,FrameName2,<span class="string">&#x27;R1&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;Global&#x27;</span>)</span><br><span class="line">[FrameName3,ret] = SapModel.FrameObj.AddByCoord(-<span class="number">4</span>,<span class="number">0</span>,<span class="number">10</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">10</span>,FrameName3,<span class="string">&#x27;R1&#x27;</span>,<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;Global&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># assign point object restraint at base</span></span><br><span class="line"><span class="comment"># 在基础的节点施加约束</span></span><br><span class="line"><span class="comment"># PointName1 = &#x27; &#x27;</span></span><br><span class="line"><span class="comment"># PointName2 = &#x27; &#x27;</span></span><br><span class="line">PointName1 , PointName2 = <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># 指定节点约束为：u1,u2,u3,r1，剩余的方向释放约束</span></span><br><span class="line">Restraint = [<span class="literal">True</span>, <span class="literal">True</span>, <span class="literal">True</span>, <span class="literal">True</span>, <span class="literal">False</span>, <span class="literal">False</span>]</span><br><span class="line"><span class="comment"># 获取FrameName1的节点1和节点2</span></span><br><span class="line">[PointName1,PointName2,ret] = SapModel.FrameObj.GetPoints(FrameName1,PointName1,PointName2)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将FrameName1的PointName1的约束设置为定义好的Restraint</span></span><br><span class="line">ret = SapModel.PointObj.SetRestraint(PointName1,Restraint)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># assign point object restraint at top</span></span><br><span class="line"><span class="comment"># 在顶部指定点对象约束</span></span><br><span class="line"><span class="comment"># 指定节点的约束为：u1,u2,剩余的方向释放约束</span></span><br><span class="line">Restraint = [<span class="literal">True</span>,<span class="literal">True</span>,<span class="literal">False</span>,<span class="literal">False</span>,<span class="literal">False</span>,<span class="literal">False</span>]</span><br><span class="line">[PointName1,PointName2,ret] = SapModel.FrameObj.GetPoints(FrameName2,PointName1,PointName2)</span><br><span class="line"><span class="comment"># 将FrameName1的PointName2的约束设置为定义好的Restraint</span></span><br><span class="line">ret = SapModel.PointObj.SetRestraint(PointName2,Restraint)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># refresh view,updata(initialize) zoom</span></span><br><span class="line"><span class="comment"># 刷新视图，初始化缩放</span></span><br><span class="line">ret = SapModel.View.RefreshView(<span class="number">0</span>,<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># add load patterns</span></span><br><span class="line"><span class="comment"># 添加荷载模式</span></span><br><span class="line"><span class="comment"># 选定的荷载模式为第8种的OTHER方式</span></span><br><span class="line">LTYPE_OTHER = <span class="number">8</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 设定名称为1~7的荷载模式</span></span><br><span class="line">ret = SapModel.LoadPatterns.Add(<span class="string">&#x27;1&#x27;</span>,LTYPE_OTHER,<span class="number">1</span>,<span class="literal">True</span>)</span><br><span class="line">ret = SapModel.LoadPatterns.Add(<span class="string">&#x27;2&#x27;</span>,LTYPE_OTHER,<span class="number">0</span>,<span class="literal">True</span>)</span><br><span class="line">ret = SapModel.LoadPatterns.Add(<span class="string">&#x27;3&#x27;</span>,LTYPE_OTHER,<span class="number">0</span>,<span class="literal">True</span>)</span><br><span class="line">ret = SapModel.LoadPatterns.Add(<span class="string">&#x27;4&#x27;</span>,LTYPE_OTHER,<span class="number">0</span>,<span class="literal">True</span>)</span><br><span class="line">ret = SapModel.LoadPatterns.Add(<span class="string">&#x27;5&#x27;</span>,LTYPE_OTHER,<span class="number">0</span>,<span class="literal">True</span>)</span><br><span class="line">ret = SapModel.LoadPatterns.Add(<span class="string">&#x27;6&#x27;</span>,LTYPE_OTHER,<span class="number">0</span>,<span class="literal">True</span>)</span><br><span class="line">ret = SapModel.LoadPatterns.Add(<span class="string">&#x27;7&#x27;</span>,LTYPE_OTHER,<span class="number">0</span>,<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># assign loading for load pattern 2</span></span><br><span class="line"><span class="comment"># 为第二种荷载模式施加荷载，在FrameName3两端的节点施加相应的节点荷载</span></span><br><span class="line">[PointName1,PointName2,ret] = SapModel.FrameObj.GetPoints(FrameName3,PointName1,PointName2)</span><br><span class="line">PointLoadValue = [<span class="number">0</span>,<span class="number">0</span>,-<span class="number">10</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line">ret = SapModel.PointObj.SetLoadForce(PointName1,<span class="string">&#x27;2&#x27;</span>,PointLoadValue)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 对FrameName3施加荷载模式名称为2的分布荷载</span></span><br><span class="line">ret = SapModel.FrameObj.SetLoadDistributed(FrameName3,<span class="string">&#x27;2&#x27;</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1.8</span>,<span class="number">1.8</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># assign loading for load pattern 3</span></span><br><span class="line"><span class="comment"># 为第三种荷载模式施加荷载，在FrameName3两端的节点进行相应的施加</span></span><br><span class="line">[PointName1,PointName2,ret] = SapModel.FrameObj.GetPoints(FrameName3,PointName1,PointName2)</span><br><span class="line">PointLoadValue = [<span class="number">0</span>,<span class="number">0</span>,-<span class="number">17.2</span>,<span class="number">0</span>,-<span class="number">54.4</span>,<span class="number">0</span>]</span><br><span class="line">ret = SapModel.PointObj.SetLoadForce(PointName2,<span class="string">&#x27;3&#x27;</span>,PointLoadValue)</span><br><span class="line"></span><br><span class="line"><span class="comment">#assign loading for load pattern 4</span></span><br><span class="line"><span class="comment">#对FrameName2施加荷载模式名称为4的分布荷载</span></span><br><span class="line">ret = SapModel.FrameObj.SetLoadDistributed(FrameName2,<span class="string">&#x27;4&#x27;</span>,<span class="number">1</span>,<span class="number">11</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#assign loading for load pattern 5</span></span><br><span class="line"><span class="comment">#对FrameName1,FrameName2施加荷载模式名称为5的分布荷载,坐标系选择为局部坐标系</span></span><br><span class="line">ret = SapModel.FrameObj.SetLoadDistributed(FrameName1,<span class="string">&#x27;5&#x27;</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="string">&#x27;Local&#x27;</span>)</span><br><span class="line">ret = SapModel.FrameObj.SetLoadDistributed(FrameName2,<span class="string">&#x27;5&#x27;</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">1</span>,-<span class="number">2</span>,-<span class="number">2</span>,<span class="string">&#x27;Local&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#assign loading for load pattern 6</span></span><br><span class="line"><span class="comment">#对FrameName1,FrameName2施加荷载模式名称为6的分布荷载,坐标系选择为局部坐标系</span></span><br><span class="line">ret = SapModel.FrameObj.SetLoadDistributed(FrameName1,<span class="string">&#x27;6&#x27;</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0.9984</span>,<span class="number">0.3744</span>,<span class="string">&#x27;Local&#x27;</span>)</span><br><span class="line">ret = SapModel.FrameObj.SetLoadDistributed(FrameName2,<span class="string">&#x27;6&#x27;</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">1</span>,-<span class="number">0.3744</span>,<span class="number">0</span>,<span class="string">&#x27;Local&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#assign loading for load pattern 7</span></span><br><span class="line"><span class="comment">#对FrameName2局部轴的跨中位置施加荷载模式名称为7的节点荷载</span></span><br><span class="line">ret = SapModel.FrameObj.SetLoadPoint(FrameName2,<span class="string">&#x27;7&#x27;</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">0.5</span>,-<span class="number">15</span>,<span class="string">&#x27;Local&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># switch to k_in units</span></span><br><span class="line">kip_in_F=<span class="number">3</span></span><br><span class="line">ret = SapModel.SetPresentUnits(kip_in_F)</span><br><span class="line"></span><br><span class="line"><span class="comment"># save model</span></span><br><span class="line"><span class="comment"># 保存模型</span></span><br><span class="line">ret = SapModel.File.Save(ModelPath)</span><br><span class="line"></span><br><span class="line"><span class="comment"># run model(this will creat the analysis model)</span></span><br><span class="line"><span class="comment"># 运行模型，在运行的过程种会创建一个分析模型</span></span><br><span class="line">ret = SapModel.Analyze.RunAnalysis()</span><br><span class="line"></span><br><span class="line"><span class="comment">#initialize for Sap2000 results</span></span><br><span class="line"><span class="comment"># 初始化sap2000的计算结果</span></span><br><span class="line">SapResult=[<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line">[PointName1,PointName2,ret] = SapModel.FrameObj.GetPoints(FrameName2,PointName1,PointName2)</span><br><span class="line"></span><br><span class="line"><span class="comment"># get Sap2000 results for load cases 1 through 7</span></span><br><span class="line"><span class="comment"># 初始化荷载模式从1~7的sap2000的计算结果</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">7</span>):</span><br><span class="line">        <span class="comment"># 结果数量，这里预先定义为0</span></span><br><span class="line">        NumberResults = <span class="number">0</span></span><br><span class="line">        <span class="comment"># 分别是对象、单元、荷载、分析步类型、分析步数量、以及6个方向的位移</span></span><br><span class="line">        Obj,Elm,ACase,StepType,StepNum,U1,U2,U3,R1,R2,R3 = [],[],[],[],[],[],[],[],[],[],[]</span><br><span class="line">        <span class="comment"># 定义对象单元也为0（不知道理解的对不对）</span></span><br><span class="line">        ObjectElm = <span class="number">0</span></span><br><span class="line">        <span class="comment"># 删除所有对荷载和荷载组合的选择</span></span><br><span class="line">        ret = SapModel.Results.Setup.DeselectAllCasesAndCombosForOutput()</span><br><span class="line">        <span class="comment"># 按照循环来选择相应的荷载和荷载组合，i从0取到6，将7个荷载模式都循环一遍</span></span><br><span class="line">        ret = SapModel.Results.Setup.SetCaseSelectedForOutput(<span class="built_in">str</span>(i+<span class="number">1</span>))</span><br><span class="line">        <span class="comment"># 如果是运行到前三个荷载模式</span></span><br><span class="line">        <span class="keyword">if</span> i &lt;= <span class="number">3</span>:</span><br><span class="line">            [NumberResults, Obj, Elm, ACase, StepType, StepNum, U1, U2, U3, R1, R2, R3, ret] = SapModel.Results.JointDispl(PointName2, ObjectElm, NumberResults, Obj, Elm, ACase, StepType, StepNum,U1,U2,U3,R1,R2,R3)</span><br><span class="line">            <span class="comment"># 这段代码没有理解，下面的代码同理</span></span><br><span class="line">            SapResult[i] = U3[<span class="number">0</span>]</span><br><span class="line">        <span class="comment"># 运行到后面4个荷载模式</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            [NumberResults, Obj, Elm, ACase, StepType, StepNum, U1, U2, U3, R1, R2, R3, ret] = SapModel.Results.JointDispl(PointName1, ObjectElm, NumberResults, Obj, Elm, ACase, StepType, StepNum, U1, U2, U3, R1, R2, R3)</span><br><span class="line">            SapResult[i] = U1[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># fill independent results</span></span><br><span class="line"><span class="comment"># 填写独立的结果</span></span><br><span class="line">IndResult = [<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line">IndResult[<span class="number">0</span>] = -<span class="number">0.02639</span></span><br><span class="line">IndResult[<span class="number">1</span>] = <span class="number">0.06296</span></span><br><span class="line">IndResult[<span class="number">2</span>] = <span class="number">0.06296</span></span><br><span class="line">IndResult[<span class="number">3</span>] = -<span class="number">0.2963</span></span><br><span class="line">IndResult[<span class="number">4</span>] = <span class="number">0.3125</span></span><br><span class="line">IndResult[<span class="number">5</span>] = <span class="number">0.11556</span></span><br><span class="line">IndResult[<span class="number">6</span>] = <span class="number">0.00651</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># fill percent diffence</span></span><br><span class="line">PercentDiff = [<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">7</span>):</span><br><span class="line">    PercentDiff[i]=(SapResult[i]/IndResult[i])-<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># display results</span></span><br><span class="line"><span class="comment"># 打印结果</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">7</span>):</span><br><span class="line">    <span class="built_in">print</span>()</span><br><span class="line">    <span class="built_in">print</span>(SapResult[i])</span><br><span class="line">    <span class="built_in">print</span>(IndResult[i])</span><br><span class="line">    <span class="built_in">print</span>(PercentDiff[i])</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/07/04/sap2000%E4%B9%8Bpython%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91/" data-id="claqum2ds0019h0tk0z9ag6v3" data-title="sap2000之python二次开发" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/8/">8</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Gridea/" rel="tag">Gridea</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python%E7%9F%A5%E8%AF%86%E5%B0%8F%E8%AE%B0/" rel="tag">python知识小记</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%B7%A5%E4%BD%9C%E4%B9%8B%E4%BD%99%E7%9A%84%E5%B0%8F%E7%9A%84%E7%BC%96%E7%A8%8B%E5%B0%8F%E7%9F%A5%E8%AF%86/" rel="tag">工作之余的小的编程小知识</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%AE%97%E6%B3%95%E4%B8%93%E6%A0%8F%EF%BC%88%E7%94%A8python%E6%B3%A8%E5%86%99%EF%BC%89/" rel="tag">算法专栏（用python注写）</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AF%BB%E4%B9%A6%E6%91%98%E8%AE%B0/" rel="tag">读书摘记</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Gridea/" style="font-size: 10px;">Gridea</a> <a href="/tags/python%E7%9F%A5%E8%AF%86%E5%B0%8F%E8%AE%B0/" style="font-size: 13.33px;">python知识小记</a> <a href="/tags/%E5%B7%A5%E4%BD%9C%E4%B9%8B%E4%BD%99%E7%9A%84%E5%B0%8F%E7%9A%84%E7%BC%96%E7%A8%8B%E5%B0%8F%E7%9F%A5%E8%AF%86/" style="font-size: 16.67px;">工作之余的小的编程小知识</a> <a href="/tags/%E7%AE%97%E6%B3%95%E4%B8%93%E6%A0%8F%EF%BC%88%E7%94%A8python%E6%B3%A8%E5%86%99%EF%BC%89/" style="font-size: 20px;">算法专栏（用python注写）</a> <a href="/tags/%E8%AF%BB%E4%B9%A6%E6%91%98%E8%AE%B0/" style="font-size: 10px;">读书摘记</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/11/">November 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/10/">October 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/09/">September 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/07/">July 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/06/">June 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/05/">May 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/04/">April 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/03/">March 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">September 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">November 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">August 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">January 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2022/11/21/hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/2022/11/12/%E6%90%AD%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84%E5%8D%9A%E5%AE%A2%E5%B9%B6%E8%BF%9B%E8%A1%8C%E7%9B%B8%E5%BA%94%E7%9A%84%E5%90%8C%E6%AD%A5/">搭建自己的博客并进行相应的同步</a>
          </li>
        
          <li>
            <a href="/2022/10/03/vs%20code%E5%AF%BC%E5%85%A5%E6%9C%AC%E5%9C%B0%E5%B7%A5%E5%85%B7%E5%8C%85/">关于vs code导入本地工具包和消除&#39;import [module] could not be resolved in pylance&#39;</a>
          </li>
        
          <li>
            <a href="/2022/09/25/%E5%85%B3%E4%BA%8Ematalab%E7%9A%84%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/">关于matalab的数据分析</a>
          </li>
        
          <li>
            <a href="/2022/07/30/%E5%85%B3%E4%BA%8Epython%E7%88%AC%E8%99%AB%E4%B8%80%E7%82%B9%E5%B0%8F%E7%9A%84%E6%95%B4%E7%90%86/">关于python爬虫一点小的整理</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2022 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>